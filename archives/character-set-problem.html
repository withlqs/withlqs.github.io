<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> Character Set Problem · Getline</title><meta name="description" content="Character Set Problem - Lqs"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600" type="text/css"></head><body><header><a href="/" class="logo-link"><img src="/favicon.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="https://github.com/withlqs" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">Character Set Problem</h1><div class="post-time">Dec 2, 2015</div><div class="post-content"><ul><li>Time Limit: 1s</li><li>Memory Limit: 256MB</li></ul><p><strong>[Description]</strong></p><p>There is a long character sequence with length $n$. For its every bit, we can choose a character from set $S$ which contains $|S|$ characters.<br><a id="more"></a><br>Set $S$ consists of three sets, $A$, $B$ and $C$. In other words, $A\cup B\cup C = S$，$A\cap B = \emptyset, A\cap C = \emptyset, B\cap C = \emptyset$.</p><p>We could say a sequence is legal that satisfied following condition:<br>Every character in set $A$ must appear even times in sequence;<br>Every character in set $B$ must appear odd times in sequence.<br>For every character in set $C$, it doesn’t have any limitation. In other wise, for every character in set $C$, it could appear even times or odd times, of course may be zero.</p><p>Please calculate the number of all different legal sequence with length $n$.</p><p>We also give you $|A|+|B|$ integers, every integer denote a character. For a integer $M_i$ we given, if number of its different prime factors is odd, $M_i$ belongs to set $A$. Otherwise, it belongs to set $B$.</p><p><strong>[Input]</strong></p><p>First line, an integer $T$ denotes the number of test cases.</p><p>For every test case:<br>The first line, there are three integers denoting $n$, $|S|$, $M$. $1\le n\le 10^{18}$，$1\le |S|\le 200$，$0\le M\le |S|$.<br>The second line, there will be $|M|$ integers. The character denoted by $M_i$ belongs to set $A$ or set $B$, $1\le M_i\le 10^{17}$.<br>For any $M_i$ and $M_j$, $|M_i-M_j|\le 10^6$.</p><p><strong>[Output]</strong></p><p>For every test case, you should output an integer denoting the number of all different legal sequences with length $n$, which should be a remainder divided by $1000000007$.</p><p><strong>[Sample Input]</strong></p><p>1<br>2 10 2<br>2 6</p><p><strong>[Sample Output]</strong></p><p>16</p><p><strong>[Author]</strong></p><p>Qiushi Li</p></div></article></div></section><footer><div class="paginator"><a href="/archives/code-formatting.html" class="next">NEXT</a></div><div id="disqus_thread"></div><script>var disqus_shortname = 'withlqs';
var disqus_identifier = 'archives/character-set-problem.html';
var disqus_title = 'Character Set Problem';
var disqus_url = 'http://blog.getline.me/archives/character-set-problem.html';
(function() {
    var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
})();</script><script id="dsq-count-scr" src="//withlqs.disqus.com/count.js" async></script><div class="copyright"><p>© 2014 - 2016 <a href="http://blog.getline.me">Lqs</a>, unless otherwise noted.</p></div></footer><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-75647552-1",'auto');ga('send','pageview');</script><script>var _hmt = _hmt || [];(function() {var hm = document.createElement("script");hm.src = "//hm.baidu.com/hm.js?8978c59b82423e1003b06eb8eaafe80a";var s = document.getElementsByTagName("script")[0]; s.parentNode.insertBefore(hm, s);})();</script><script type="text/x-mathjax-config">MathJax.Hub.Config({config:["MMLorHTML.js"],jax:["input/TeX","input/MathML","input/AsciiMath","output/HTML-CSS","output/NativeMML","output/PreviewHTML"],extensions:["tex2jax.js","mml2jax.js","asciimath2jax.js","MathMenu.js","MathZoom.js","fast-preview.js","AssistiveMML.js"],tex2jax:{inlineMath:[['$','$'],["\\(","\\)"]],displayMath:[['$$','$$'],["\\[","\\]"]],processEscapes:true},TeX:{extensions:["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]}});</script><script src="/MathJax/MathJax.js"></script></body></html>